let AdminBSB = {};

AdminBSB.toastr = {
    "closeButton": false,
    "debug": false,
    "newestOnTop": false,
    "progressBar": false,
    "positionClass": "toast-bottom-right",
    "preventDuplicates": false,
    "onclick": null,
    "showDuration": "300",
    "hideDuration": "1000",
    "timeOut": "5000",
    "extendedTimeOut": "1000",
    "showEasing": "swing",
    "hideEasing": "linear",
    "showMethod": "fadeIn",
    "hideMethod": "fadeOut"
};

/* Left Sidebar - Function =================================================================================================
*  You can manage the left sidebar menu options
*
*/
AdminBSB.leftSideBar = {
    activate: function () {
        var _this = this;
        var $body = jQuery('body');
        var $overlay = jQuery('.overlay');

        //Close sidebar
        jQuery(window).click(function (e) {
            var $target = jQuery(e.target);
            if (e.target.nodeName.toLowerCase() === 'i') { $target = jQuery(e.target).parent(); }

            if (!$target.hasClass('bars') && _this.isOpen() && $target.parents('#leftsidebar').length === 0) {
                if (!$target.hasClass('js-right-sidebar')) $overlay.fadeOut();
                $body.removeClass('overlay-open');
            }
        });

        jQuery.each(jQuery('.menu-toggle.toggled'), function (i, val) {
            jQuery(val).next().slideToggle('fast');
        });

        //When page load
        jQuery('.menu .list li.active').removeClass('active');
        jQuery('.menu .list li a').each(function () {
            if (jQuery(this).prop('href') == location.href) {
                jQuery('.menu .list li.active').removeClass('active');
                jQuery(this).parent().parent().parent().addClass('active');
                jQuery(this).parent().addClass('active');

                return false;
            } else {
                var href = jQuery(this).prop('href');
                var hrefPart = href.split('/');
                if (hrefPart[4] && hrefPart[4] == currentSegment[1]) {
                    jQuery('.menu .list li.active').removeClass('active');
                    jQuery(this).parent().parent().parent().addClass('active');
                    jQuery(this).parent().addClass('active');
                }
            }
        });
        jQuery.each(jQuery('.menu .list li.active'), function (i, val) {
            var $activeAnchors = jQuery(val).find('a:eq(0)');
            $activeAnchors.addClass('toggled');
            $activeAnchors.next().show();
        });

        //Collapse or Expand Menu
        jQuery('.menu-toggle').on('click', function (e) {
            var $this = jQuery(this);
            var $content = $this.next();

            if (jQuery($this.parents('ul')[0]).hasClass('list')) {
                var $not = jQuery(e.target).hasClass('menu-toggle') ? e.target : jQuery(e.target).parents('.menu-toggle');

                jQuery.each(jQuery('.menu-toggle.toggled').not($not).next(), function (i, val) {
                    if (jQuery(val).is(':visible')) {
                        jQuery(val).prev().toggleClass('toggled');
                        jQuery(val).slideUp('fast');
                    }
                });
            }

            $this.toggleClass('toggled');
            $content.slideToggle('fast');
        });

        //Set Waves
        Waves.attach('.menu .list a', ['waves-block']);
        Waves.init();
    },
    isOpen: function () {
        return jQuery('body').hasClass('overlay-open');
    }
};

AdminBSB.input = {
    activate: function ($parentSelector) {
        $parentSelector = $parentSelector || jQuery('body');

        //On focus event
        $parentSelector.find('.form-control').focus(function () {
            jQuery(this).closest('.form-line').addClass('focused');
        });

        //On focusout event
        $parentSelector.find('.form-control').focusout(function () {
            var $this = jQuery(this);
            if ($this.parents('.form-group').hasClass('form-float')) {
                if ($this.val() == '') { $this.parents('.form-line').removeClass('focused'); }
            }
            else {
                $this.parents('.form-line').removeClass('focused');
            }
        });

        //On label click
        $parentSelector.on('click', '.form-float .form-line .form-label', function () {
            jQuery(this).parent().find('input').focus();
        });

        //Not blank form
        $parentSelector.find('.form-control').each(function () {
            if (jQuery(this).val() !== '') {
                jQuery(this).parents('.form-line').addClass('focused');
            }
        });
    }
};

AdminBSB.rangeCalendar = {
    activate: function (el) {
        el.daterangepicker({
            "showDropdowns": true,
            "minYear": 2021,
            "maxYear": 2099,
            "autoApply": false,
            ranges: {
                'Hôm nay': [moment(), moment()],
                'Hôm qua': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                '7 ngày trước': [moment().subtract(6, 'days'), moment()],
                '30 ngày trước': [moment().subtract(29, 'days'), moment()],
                'Tháng này': [moment().startOf('month'), moment().endOf('month')],
                'Tháng trước': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            },
            "locale": {
                "format": "DD/MM/YYYY",
                "separator": " - ",
                "applyLabel": "Chọn",
                "cancelLabel": "Hủy",
                "fromLabel": "Từ",
                "toLabel": "Đến",
                "customRangeLabel": "Chọn ngày",
                "weekLabel": "Tuần",
                "daysOfWeek": [
                    "CN",
                    "T2",
                    "T3",
                    "T4",
                    "T5",
                    "T6",
                    "T7"
                ],
                "monthNames": [
                    "Tháng 1",
                    "Tháng 2",
                    "Tháng 3",
                    "Tháng 4",
                    "Tháng 5",
                    "Tháng 6",
                    "Tháng 7",
                    "Tháng 8",
                    "Tháng 9",
                    "Tháng 10",
                    "Tháng 11",
                    "Tháng 12"
                ],
                "firstDay": 1
            },
            "linkedCalendars": false,
            "alwaysShowCalendars": true,
            "drops": "auto"
        });
    }
};

jQuery(function () {
    AdminBSB.leftSideBar.activate();
    AdminBSB.input.activate();
});
